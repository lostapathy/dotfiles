# vim: set nospell:
---
- hosts: localhost
  become: true
  connection: local

  tasks:
  - name: Install packages
    apt:
      name:
        - grip
        - build-essential
        - libssl-dev
        - libreadline-dev
        - zlib1g-dev
        - exuberant-ctags
        - golang-go
        - docker.io
        - libmysqlclient-dev
        - libpq-dev
        - libsqlite3-dev
        - graphviz
        - mariadb-client

  - name: enable docker
    service:
      name: docker
      state: started
      enabled: yes
      masked: false
      #
  # FIXME: have this pull account username from file
  - name: put joe in docker group
    user:
      name: joe
      groups: docker
      append: yes

  - name: Setup asdf-vm
    become: yes
    become_user: joe
    git:
      repo: https://github.com/asdf-vm/asdf.git
      dest: /home/joe/.asdf
      update: yes

  - name: run ansible galaxy
    local_action: command ansible-galaxy install -r requirements.yml --ignore-errors

  roles:
  - role: ansible-role-asdf
    asdf_user: joe
    asdf_plugins:
      - name: 'ruby'
      - name: 'python'
      - name: 'yarn'
      - name: 'nodejs'
      - name: 'terraform'
      - name: 'golang'
      - name: 'ripgrep'
      - name: 'doctl'
      - name: 'fzf'
      - name: 'github-cli'
      - name: 'hadolint'
