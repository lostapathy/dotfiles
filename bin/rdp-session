#!/bin/bash
# pipe password to sdin
# $1 = host:port
# $2 = username
# $3 = title

PASS=`less <&0`

# Just remove this so when we're working over port forwarding we don't have errors
rm ~/.config/freerdp/known_hosts -f

set -o xtrace

xfreerdp /audio-mode:0 /sec:tls /admin /u:$2 /p:$PASS /d:vc-mfg /v:$1 /cert-ignore \
  /gfx /jpeg-quality:70 /jpeg +compression /network:lan \
  +async-update +async-input +async-channels \
  -themes -wallpaper -menu-anims -aero -window-drag \
  /t:$3 +clipboard -grab-keyboard /log-level:off \
  /size:${RDP_SIZE:=1280x1024} /scale:${RDP_SCALE:=100} ${EXTRA_XFREERDP_ARGS}
